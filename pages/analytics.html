<!doctype html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Analytics ‚Ä¢ Hospital ERP</title>
  <link rel="stylesheet" href="../styles/styles.css"/>
  <script defer src="../scripts/utils.js"></script>
</head>
<body>
  <header class="banner">
    <button class="toggle" id="themeToggle" title="Toggle theme">üåô</button>
  </header>

  <div class="toolbar">
    <a class="chip" href="../index.html">‚Üê Dashboard</a>
    <button class="chip" id="clearCacheBtn">Clear Cache</button>
  </div>

  <section class="section">
    <div class="panel grad-lilac"><h2>Sales Analytics</h2></div>

    <div class="section" style="margin-top:12px">
      <div class="row">
        <input type="date" id="from" style="max-width:200px"/>
        <input type="date" id="to" style="max-width:200px"/>
        <button id="run" class="chip chip--primary">Run</button>
        <button class="chip" data-q="today">Today</button>
        <button class="chip" data-q="7d">7D</button>
        <button class="chip" data-q="30d">30D</button>
        <button class="chip" data-q="ytd">YTD</button>
      </div>

      <div class="kpi-grid" style="margin-top:12px">
        <div class="kpi grad-sky"><div class="label">Total (‚Çπ)</div><div class="num" id="kTotal">0.00</div></div>
        <div class="kpi grad-lilac"><div class="label">Avg / Day (‚Çπ)</div><div class="num" id="kAvg">0.00</div></div>
        <div class="kpi grad-mint"><div class="label">Invoices</div><div class="num" id="kInv">0</div></div>
        <div class="kpi grad-rose"><div class="label">Top Item</div><div class="num" id="kTop">‚Äî</div></div>
      </div>
    </div>

    <div class="section">
      <h3 style="margin:0 0 8px">Daily Revenue</h3>
      <div style="height:220px;border-radius:14px;background:linear-gradient(180deg,rgba(255,255,255,.06),transparent);box-shadow:var(--shadow);display:grid;place-items:center;color:var(--muted)">Chart placeholder</div>
    </div>

    <div class="section">
      <h3 style="margin:0 0 8px">Top Items</h3>
      <table class="table" id="topItems">
        <thead><tr><th>Item</th><th>Qty</th><th>Amount</th></tr></thead>
        <tbody><tr><td class="muted" colspan="3">No items</td></tr></tbody>
      </table>
    </div>
  </section>

  <script>
    // theme
    const html=document.documentElement, t=document.getElementById('themeToggle');
    function sync(){t.textContent=html.dataset.theme==='dark'?'üåô':'üåû'}; t.onclick=()=>{html.dataset.theme=html.dataset.theme==='dark'?'light':'dark'; localStorage.setItem('theme',html.dataset.theme); sync();}; html.dataset.theme=localStorage.getItem('theme')||'dark'; sync();
    // quick range helpers
    const setRange = (days)=>{ const to=new Date(), from=new Date(); from.setDate(to.getDate()-days+1); document.getElementById('from').value=from.toISOString().slice(0,10); document.getElementById('to').value=to.toISOString().slice(0,10); };
    document.querySelectorAll('[data-q]').forEach(b=>b.onclick=()=>{ const q=b.dataset.q; if(q==='today') setRange(1); if(q==='7d') setRange(7); if(q==='30d') setRange(30); if(q==='ytd'){ const d=new Date(); document.getElementById('from').value=`${d.getFullYear()}-01-01`; document.getElementById('to').value=new Date().toISOString().slice(0,10);} });
    setRange(7);
    document.getElementById('clearCacheBtn')?.addEventListener('click',()=>{localStorage.clear(); alert('Cache cleared');});
  </script>
</body>
</html>
